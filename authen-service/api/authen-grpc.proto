syntax="proto3";

package proto;

option go_package = "github.com/billzayy/social-media/back-end/authen-service/api";

service AuthService {
    rpc Register(RegisterReq) returns (RegisterResp);
    rpc Login(LoginReq) returns (LoginResp);
    rpc RefreshToken(RefreshTokenReq) returns (RefreshTokenResp);
}

// Register Req & Resp
message RegisterReq {
    string UserName = 1;
    string Email = 2;
    string FirstName = 3;
    string SurName = 4;
    string Password = 5;
    string Location = 6;
    string BirthDate = 7;
    string Description = 8;
    repeated string Website = 9; 
}

message RegisterResp {
    bool Successful = 1;
}

// Login Req & Resp
message LoginReq{
    string UserName = 1;
    string Password = 2;
}

message LoginResp{
    UserResp User = 1;
    string Token = 2;
    string Cookie = 3;
    string Type = 4;
    int64 Expires= 5;
}

message UserResp{
    string ID = 1;
    string FullName = 2;
    string Email = 3;
    string ProfilePicture = 4;
}

// RefreshToken Req & Resp
message RefreshTokenReq{
    string RefreshToken = 1;
}

message RefreshTokenResp{
    UserResp User = 1;
    string Token = 2;
    string Cookie = 3;
    string Type = 4;
    int64 Expires = 5;
}
